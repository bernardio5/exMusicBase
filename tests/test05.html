<!DOCTYPE html >
<head>
	<title>exMusicBase/tests</title>
	<script type="text/javascript" src="../exMusic.js"></script>  
	<script type="text/javascript" src="../exDisplay.js"></script>  
	<script type="text/javascript">		
	var theClef, theLine, theKey, theList, theMet, base; 

	function generate() { 
		var baseNote, key2, i;
		
		baseNote = new exNote(); 		
		theList = new exNoteList(); 
		
		for (i=0; i<36; i=i+1) {
			baseNote.t = i*.75; 
			baseNote.midi = 36+i; 
			theList.add(baseNote); 
		}

	}


	function setParameters() { 
        theKey.setModeFromHTMLControl(document);
        theClef.setKey(theKey); 
       	generate(); 
	}


	function starter() { 
		base = 0; 
		theKey = new exKey(); 
		generate(); 

		var theConts = document.getElementById("exControlHolder");
		theConts.innerHTML = theKey.getHTMLForModeControl("key1");

		var theCanvas = document.getElementById("mainCanvas");
		theClef = new exSpriteClefRow(theCanvas, theList, 0,6, 2, theKey, true);
		theClef.redrawer(); 

		theMet = new exMetronome(30, 120, 4, 16); 
		theLine = new exSpriteTimeLine(theCanvas, theList, 0,2, 2, theMet, true);
		theLine.redrawer(); 

		setInterval(redraw,6000);  
	}

	function redraw() {
		console.log("redraw");
		base = base+1;  
		theKey.setTonic((base%12)+40);
		generate(); 
		theClef.clearAll(); 
		theClef.setKey(theKey);
		theClef.redrawer(); 
		theLine.redrawer(); 

	}

	</script>
</head>
<body  onLoad="starter();">
	Test 5: HTML-control input => composition and re-composition.
	<canvas id="mainCanvas" width="782" height="320"></canvas> 
<br> 
	<div id="exControlHolder"></div>
</body>
</html>
